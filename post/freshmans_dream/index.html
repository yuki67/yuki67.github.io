<!DOCTYPE html>
<html lang="en">
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.37.1" />

  <title>一年生の夢の実装 in C&#43;&#43; &middot; yuki&#39;s blog</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://yuki67.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://yuki67.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://yuki67.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  

  

  <link rel="shortcut icon" href="https://yuki67.github.io/img/favicon.ico" type="image/x-icon" />

  
  

</head>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  
  <link rel="stylesheet" href="https://yuki67.github.io/css/custom.css">
  <link rel="stylesheet" href="https://yuki67.github.io/css/pygments.css">
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": {
      undefinedFamily: "'Raleway', Helvetica, Arial, sans-serif"
  }
  });
  </script>
  <body>
    <div id="layout">
      
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://yuki67.github.io/">yuki's blog</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://yuki67.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://yuki67.github.io/post/"><i class='fa fa-list fa-fw'></i>Post</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://yuki67.github.io/tags/%E3%82%B3%E3%83%BC%E3%83%89%E7%BD%AE%E3%81%8D%E5%A0%B4/"><i class='fa fa-terminal fa-fw'></i>Code</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://yuki67.github.io/tags/about/"><i class='fa fa-edit fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://yuki67.github.io/tags/%E3%83%A1%E3%83%A2/"><i class='fa fa-book fa-fw'></i>Memo</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://yuki67.github.io/tags/%E3%83%8E%E3%83%BC%E3%83%88/"><i class='fa fa-sticky-note fa-fw'></i>Note</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://yuki67.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tag</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/yfkutydt" target="_blank"><i class="fa fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/yuki67" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>by yuki</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>

      <div id="main">


<div class="header">
  <h1>一年生の夢の実装 in C&#43;&#43;</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">
  <span>
    <i class="fa fa-calendar fa-fw"></i>
    <time>
      
        2018-02-23
      
    </time>
  </span>
  &nbsp;&nbsp;&nbsp;
  
  
    
    
      <span>
      <i class="fa fa-tags fa-fw"></i>
      
        <a class="post-taxonomy-tag" href="https://yuki67.github.io/tags/cpp">
          cpp
        </a>
        
          &nbsp;&#47;
        
      
        <a class="post-taxonomy-tag" href="https://yuki67.github.io/tags/%E3%82%B3%E3%83%BC%E3%83%89%E7%BD%AE%E3%81%8D%E5%A0%B4">
          コード置き場
        </a>
        
      
    </span>
    
  
</div>


  


  <p>式</p>

<p>\begin{align*}
(x + y)^{p} = x^{p} + y^{p}
\end{align*}</p>

<p>を一年生の夢 (<a href="https://en.wikipedia.org/wiki/Freshman%27s_dream">Freshman&rsquo;s dream</a>) という。</p>

<p></p>

<p>普通の多項式としてはこの式は間違っているが、 有限体上の多項式としてみれば合っている。
つまり、 \(p\) を素数とすると</p>

<p>\begin{align*}
\forall x, y \in \mathbb{F}_{p}, \ (x + y)^{p} = x^{p} + y^{p}
\end{align*}</p>

<p>が成り立つ。</p>

<p><a href="https://yuki67.github.io/post/finite_field/">前回の記事</a> で有限体を実装したので、その上に多項式を実装してこの事実を確かめるコードを書いた。</p>

<h2 id="多項式">多項式</h2>

<p>まず多項式を実装した。
特に難しい部分はなかったが、
次数が大きくなったときと係数が0か1のときに <code>operator&lt;&lt;</code> が破綻しないような工夫をした。
また <code>operator+</code> と <code>operator+=</code> などでコードが使いまわせる部分についてはなるべく使いまわした。</p>

<p><div class="src-block-caption">
  <span class="src-block-number">Code Snippet 1:</span>
  polynomial.hpp
</div></p>
<div class="highlight"><pre class="chroma"><code class="language-C++" data-lang="C++"><span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;initializer_list&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;ostream&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">Coeff</span><span class="o">&gt;</span>
<span class="k">class</span> <span class="nc">Polynomial</span> <span class="p">{</span>
 <span class="k">private</span><span class="o">:</span>
  <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Coeff</span><span class="o">&gt;</span> <span class="n">m_coeffs</span><span class="p">;</span>
  <span class="c1">// m_vec末尾の0を削除する
</span><span class="c1"></span>  <span class="n">Polynomial</span> <span class="o">&amp;</span><span class="n">delete_trailing_zeros</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">m_coeffs</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">m_coeffs</span><span class="p">[</span><span class="n">m_coeffs</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">m_coeffs</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
  <span class="p">}</span>

 <span class="k">public</span><span class="o">:</span>
  <span class="k">static</span> <span class="kt">bool</span> <span class="n">print_zero</span><span class="p">;</span>

  <span class="n">Polynomial</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Coeff</span><span class="o">&gt;</span> <span class="n">coeffs</span><span class="p">)</span>
      <span class="o">:</span> <span class="n">m_coeffs</span><span class="p">(</span><span class="n">coeffs</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Coeff</span><span class="o">&gt;</span><span class="p">{</span><span class="mi">0</span><span class="p">}</span> <span class="o">:</span> <span class="n">coeffs</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">delete_trailing_zeros</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="n">Polynomial</span><span class="p">()</span> <span class="o">:</span> <span class="n">m_coeffs</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Coeff</span><span class="o">&gt;</span><span class="p">{</span><span class="mi">0</span><span class="p">})</span> <span class="p">{}</span>

  <span class="n">Polynomial</span><span class="p">(</span><span class="k">const</span> <span class="n">Coeff</span> <span class="o">&amp;</span><span class="n">c</span><span class="p">)</span> <span class="o">:</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Coeff</span><span class="o">&gt;</span><span class="p">{</span><span class="n">c</span><span class="p">})</span> <span class="p">{}</span>

  <span class="n">Polynomial</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">initializer_list</span><span class="o">&lt;</span><span class="n">Coeff</span><span class="o">&gt;</span> <span class="n">coeffs</span><span class="p">)</span>
      <span class="o">:</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Coeff</span><span class="o">&gt;</span><span class="p">(</span><span class="n">coeffs</span><span class="p">))</span> <span class="p">{}</span>

  <span class="n">size_t</span> <span class="n">degree</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_coeffs</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}</span>

  <span class="n">Coeff</span> <span class="k">operator</span><span class="p">[](</span><span class="n">size_t</span> <span class="n">i</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_coeffs</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="p">}</span>

  <span class="k">friend</span> <span class="kt">bool</span> <span class="k">operator</span><span class="o">==</span><span class="p">(</span><span class="k">const</span> <span class="n">Polynomial</span> <span class="o">&amp;</span><span class="n">lhs</span><span class="p">,</span> <span class="k">const</span> <span class="n">Polynomial</span> <span class="o">&amp;</span><span class="n">rhs</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">lhs</span><span class="p">.</span><span class="n">m_coeffs</span> <span class="o">==</span> <span class="n">rhs</span><span class="p">.</span><span class="n">m_coeffs</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">friend</span> <span class="kt">bool</span> <span class="k">operator</span><span class="o">!=</span><span class="p">(</span><span class="k">const</span> <span class="n">Polynomial</span> <span class="o">&amp;</span><span class="n">lhs</span><span class="p">,</span> <span class="k">const</span> <span class="n">Polynomial</span> <span class="o">&amp;</span><span class="n">rhs</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">lhs</span><span class="p">.</span><span class="n">m_coeffs</span> <span class="o">!=</span> <span class="n">rhs</span><span class="p">.</span><span class="n">m_coeffs</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">Polynomial</span> <span class="o">&amp;</span><span class="k">operator</span><span class="o">+=</span><span class="p">(</span><span class="k">const</span> <span class="n">Polynomial</span> <span class="o">&amp;</span><span class="n">other</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">m_coeffs</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">max</span><span class="p">(</span><span class="n">degree</span><span class="p">(),</span> <span class="n">other</span><span class="p">.</span><span class="n">degree</span><span class="p">()));</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="p">.</span><span class="n">degree</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">m_coeffs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">other</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">delete_trailing_zeros</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="n">Polynomial</span> <span class="o">&amp;</span><span class="k">operator</span><span class="o">-=</span><span class="p">(</span><span class="k">const</span> <span class="n">Polynomial</span> <span class="o">&amp;</span><span class="n">other</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">m_coeffs</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">std</span><span class="o">::</span><span class="n">max</span><span class="p">(</span><span class="n">degree</span><span class="p">(),</span> <span class="n">other</span><span class="p">.</span><span class="n">degree</span><span class="p">()));</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="p">.</span><span class="n">degree</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">m_coeffs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="n">other</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">delete_trailing_zeros</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="n">Polynomial</span> <span class="o">&amp;</span><span class="k">operator</span><span class="o">*=</span><span class="p">(</span><span class="k">const</span> <span class="n">Polynomial</span> <span class="o">&amp;</span><span class="n">other</span><span class="p">)</span> <span class="p">{</span>
    <span class="o">*</span><span class="k">this</span> <span class="o">=</span> <span class="o">*</span><span class="k">this</span> <span class="o">*</span> <span class="n">other</span><span class="p">;</span>
    <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">friend</span> <span class="n">Polynomial</span> <span class="k">operator</span><span class="o">+</span><span class="p">(</span><span class="k">const</span> <span class="n">Polynomial</span> <span class="o">&amp;</span><span class="n">lhs</span><span class="p">,</span> <span class="k">const</span> <span class="n">Polynomial</span> <span class="o">&amp;</span><span class="n">rhs</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">auto</span> <span class="n">temp</span><span class="p">(</span><span class="n">lhs</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">temp</span> <span class="o">+=</span> <span class="n">rhs</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">friend</span> <span class="n">Polynomial</span> <span class="k">operator</span><span class="o">-</span><span class="p">(</span><span class="k">const</span> <span class="n">Polynomial</span> <span class="o">&amp;</span><span class="n">lhs</span><span class="p">,</span> <span class="k">const</span> <span class="n">Polynomial</span> <span class="o">&amp;</span><span class="n">rhs</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">auto</span> <span class="n">temp</span><span class="p">(</span><span class="n">lhs</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">temp</span> <span class="o">-=</span> <span class="n">rhs</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">friend</span> <span class="n">Polynomial</span> <span class="k">operator</span><span class="o">*</span><span class="p">(</span><span class="k">const</span> <span class="n">Polynomial</span> <span class="o">&amp;</span><span class="n">lhs</span><span class="p">,</span> <span class="k">const</span> <span class="n">Polynomial</span> <span class="o">&amp;</span><span class="n">rhs</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Coeff</span><span class="o">&gt;</span> <span class="n">answer</span><span class="p">(</span><span class="n">lhs</span><span class="p">.</span><span class="n">degree</span><span class="p">()</span> <span class="o">+</span> <span class="n">rhs</span><span class="p">.</span><span class="n">degree</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">rhs</span><span class="p">.</span><span class="n">degree</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">size_t</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">lhs</span><span class="p">.</span><span class="n">degree</span><span class="p">();</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">answer</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">rhs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">lhs</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">{</span><span class="n">answer</span><span class="p">};</span>
  <span class="p">}</span>

  <span class="c1">// このイテレータは今回の例では使っていない
</span><span class="c1"></span>  <span class="k">typename</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Coeff</span><span class="o">&gt;::</span><span class="n">const_iterator</span> <span class="n">begin</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">m_coeffs</span><span class="p">.</span><span class="n">cbegin</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="k">typename</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Coeff</span><span class="o">&gt;::</span><span class="n">const_iterator</span> <span class="n">end</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">m_coeffs</span><span class="p">.</span><span class="n">cend</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="k">friend</span> <span class="n">std</span><span class="o">::</span><span class="n">ostream</span> <span class="o">&amp;</span><span class="k">operator</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">ostream</span> <span class="o">&amp;</span><span class="n">rhs</span><span class="p">,</span> <span class="k">const</span> <span class="n">Polynomial</span> <span class="o">&amp;</span><span class="n">lhs</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// 次数が 0 or 1, 係数が 0 or 1 の場合でそれぞれ場合分けをしている
</span><span class="c1"></span>    <span class="c1">// print_zero が true の場合にのみ係数の 0 が出力される
</span><span class="c1"></span>
    <span class="k">if</span> <span class="p">(</span><span class="n">lhs</span><span class="p">.</span><span class="n">degree</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">rhs</span> <span class="o">&lt;&lt;</span> <span class="n">lhs</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
      <span class="k">return</span> <span class="n">rhs</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">rhs</span> <span class="o">&lt;&lt;</span> <span class="n">lhs</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">lhs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">print_zero</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">rhs</span> <span class="o">&lt;&lt;</span> <span class="sa"></span><span class="s">&#34; + &#34;</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">lhs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">rhs</span> <span class="o">&lt;&lt;</span> <span class="n">lhs</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
      <span class="p">}</span>
      <span class="n">rhs</span> <span class="o">&lt;&lt;</span> <span class="sa"></span><span class="s">&#34;x&#34;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">lhs</span><span class="p">.</span><span class="n">degree</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="n">rhs</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">lhs</span><span class="p">.</span><span class="n">degree</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">lhs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">print_zero</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">rhs</span> <span class="o">&lt;&lt;</span> <span class="sa"></span><span class="s">&#34; + &#34;</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">lhs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
          <span class="n">rhs</span> <span class="o">&lt;&lt;</span> <span class="n">lhs</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="n">rhs</span> <span class="o">&lt;&lt;</span> <span class="sa"></span><span class="s">&#34;x^&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">rhs</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">Polynomial</span> <span class="o">&amp;</span><span class="n">pow</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Polynomial</span> <span class="n">p</span><span class="p">{</span><span class="mi">1</span><span class="p">};</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">p</span> <span class="o">*=</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="o">*</span><span class="k">this</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span>
    <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span>
<span class="kt">bool</span> <span class="n">Polynomial</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">print_zero</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
</code></pre></div>
<h2 id="確認">確認</h2>

<p>上の多項式クラスを使って以下のようにして１年生の夢が成り立つことを確かめた。</p>
<div class="highlight"><pre class="chroma"><code class="language-C++" data-lang="C++"><span class="cp">#include</span> <span class="cpf">&#34;finite_field.hpp&#34;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&#34;polynomial.hpp&#34;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// 位数が 2, 3, 11, 101, 8192 の場合について確認する
</span><span class="c1"></span>  <span class="k">using</span> <span class="n">P2</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="o">&lt;</span><span class="n">FiniteField</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;&gt;</span><span class="p">;</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="sa"></span><span class="s">&#34;In F2, (1 + x)^2 = &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">P2</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">}.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sa"></span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>

  <span class="k">using</span> <span class="n">P3</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="o">&lt;</span><span class="n">FiniteField</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;&gt;</span><span class="p">;</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="sa"></span><span class="s">&#34;In F3, (1 + x)^3 = &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">P3</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">}.</span><span class="n">pow</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sa"></span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>

  <span class="k">using</span> <span class="n">P11</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="o">&lt;</span><span class="n">FiniteField</span><span class="o">&lt;</span><span class="mi">11</span><span class="o">&gt;&gt;</span><span class="p">;</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="sa"></span><span class="s">&#34;In F11, (1 + x)^11 = &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">P11</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">}.</span><span class="n">pow</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sa"></span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>

  <span class="k">using</span> <span class="n">P101</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="o">&lt;</span><span class="n">FiniteField</span><span class="o">&lt;</span><span class="mi">101</span><span class="o">&gt;&gt;</span><span class="p">;</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="sa"></span><span class="s">&#34;In F101, (1 + x)^101 = &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">P101</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">}.</span><span class="n">pow</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sa"></span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>

  <span class="k">using</span> <span class="n">P8291</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="o">&lt;</span><span class="n">FiniteField</span><span class="o">&lt;</span><span class="mi">8291</span><span class="o">&gt;&gt;</span><span class="p">;</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="sa"></span><span class="s">&#34;In F8291, (1 + x)^8291 = &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">P8291</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">}.</span><span class="n">pow</span><span class="p">(</span><span class="mi">8291</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sa"></span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-nil" data-lang="nil">In F2, (1 + x)^2 = 1 + x^2
In F3, (1 + x)^3 = 1 + x^3
In F11, (1 + x)^11 = 1 + x^11
In F101, (1 + x)^101 = 1 + x^101
In F8291, (1 + x)^8291 = 1 + x^8291</code></pre></div>
<p><code>P8291{1, 1}.pow(8291)</code> の計算には５秒程度の時間がかかった。</p>

  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://yuki67.github.io/post/finite_field/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://yuki67.github.io/post/finite_field/">有限体の実装 in C&#43;&#43;</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://yuki67.github.io/post/bigint/">BigIntの実装 in C&#43;&#43;</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://yuki67.github.io/post/bigint/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>



  

</div>

</div>
</div>
<script src="https://yuki67.github.io/js/ui.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-107335237-1', 'auto');
  ga('send', 'pageview');

</script>





</body>
</html>

